<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Georeference an image • crstools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Georeference an image">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">crstools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/crstools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/georeference_image.html">Georeference an image</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Georeference an image</h1>
            
      

      <div class="hidden name"><code>georeference_image.Rmd</code></div>

    </div>

    
    
<p>Georeferencing is the process of assigning real-world coordinates to
an image, allowing it to be accurately placed on a map. This is often
done using Ground Control Points (GCPs), which are known locations on
the ground with precise coordinates. In this vignette, we will
demonstrate how to georeference an image using GCPs in the
<code>crstools</code> package.</p>
<p>The process of assigning GCPs to an image is interactive, allowing
you to select points on the image and assign them geographic
coordinates. Unfortunately, this is not compatible with Rmarkdown or the
image pane within RStudio. <code>crstools</code> opens separate windows
for GCP assignment and image display, and the code has to be run from a
script or the console.</p>
<p>To get started, we need to load the <code>crstools</code>
package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">crstools</span><span class="op">)</span></span></code></pre></div>
<p>Next we need a .jpg image that we scanned or downloaded. We will use
a map of Europe that is included with the package. The map has a number
of points (the capitals of UK, France, Spain, Germany, Italy, and
Iceland).</p>
<p>Our task is to georeference this image and then extract the
coordinates of those capitals. We will copy a version of the image to a
temporary directory, and work on that:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/europe_map.jpeg"</span>, package <span class="op">=</span> <span class="st">"crstools"</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">img_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"europe_map.jpeg"</span><span class="op">)</span></span></code></pre></div>
<p>We can now select a number of GCPs with <code><a href="../reference/choose_gcp.html">choose_gcp()</a></code>.
This function allows you to click on the image and assign coordinates to
the points you select. Choose locations that are easy to find again on a
map, such as features in coastlines (e.g. bays), or corners of country
boundaries.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gcp_europe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/choose_gcp.html">choose_gcp</a></span><span class="op">(</span><span class="va">img_path</span><span class="op">)</span></span></code></pre></div>
<p>This will open a window showing the image:</p>
<div class="float">
<img src="img/europe_image.png" width="500" alt="Figure: Window opened by choose_gcp()"><div class="figcaption">Figure: Window opened by
<code><a href="../reference/choose_gcp.html">choose_gcp()</a></code>
</div>
</div>
<p>You can click on the image to select points by left-clicking with
your mouse. The points will be numbered in the order in which they were
chosen; you can stop by pressing the ESC key, or with a right-click.</p>
<div class="float">
<img src="img/europe_image_GCP.png" width="500" alt="Figure: GCPs selected on the map by clicking with the mouse"><div class="figcaption">Figure: GCPs selected on the map by clicking
with the mouse</div>
</div>
<p>The coordinates of those points will be saved in the
<code>gcp_europe</code> dataframe, which contains the following
columns:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gcp_europe</span></span>
<span><span class="co">#&gt;   id         x         y longitude latitude</span></span>
<span><span class="co">#&gt; 1  1  830.3113  576.5869        NA       NA</span></span>
<span><span class="co">#&gt; 2  2 2399.7464  783.3988        NA       NA</span></span>
<span><span class="co">#&gt; 3  3 2886.9187 2617.8971        NA       NA</span></span>
<span><span class="co">#&gt; 4  4  414.0564 2537.4702        NA       NA</span></span>
<span><span class="co">#&gt; 5  5  836.4781 1645.1151        NA       NA</span></span>
<span><span class="co">#&gt; 6  6 1992.7416  561.2675        NA       NA</span></span></code></pre></div>
<p>Next we need to get the coordinates (longitude and latitude) of these
points. We can use the <code><a href="../reference/find_gcp_coords.html">find_gcp_coords()</a></code> function to assign
geographic coordinates to the GCPs. This function requires a reference
map in the form of an <code>sf</code> object. We will use the
<code>rnaturalearth</code> package to get a map of Europe, and then crop
it to the extent of the image.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rnaturalearth/" class="external-link">rnaturalearth</a></span><span class="op">)</span></span>
<span><span class="co"># Load the world map</span></span>
<span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html" class="external-link">ne_countries</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"medium"</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span></span>
<span><span class="co"># Transform it to a suitable projection</span></span>
<span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">world</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span> <span class="co"># WGS 84</span></span>
<span><span class="co"># Crop it to the extent of the image to Europe</span></span>
<span><span class="va">europe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html" class="external-link">st_crop</a></span><span class="op">(</span><span class="va">world</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">25</span>, ymin <span class="op">=</span> <span class="fl">25</span>, xmax <span class="op">=</span> <span class="fl">45</span>, ymax <span class="op">=</span> <span class="fl">70</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: attribute variables are assumed to be spatially constant throughout</span></span>
<span><span class="co">#&gt; all geometries</span></span></code></pre></div>
<p>Let’s quickly plot it to check that we have the correct extent:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">europe</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Map of Europe"</span><span class="op">)</span></span></code></pre></div>
<p>Now we can use the <code><a href="../reference/find_gcp_coords.html">find_gcp_coords()</a></code> function to assign
geographic coordinates to the GCPs.</p>
<div class="float">
<img src="img/europe_image_georef1.png" width="500" alt="Figure: Window opened by find_gcp_coords()"><div class="figcaption">Figure: Window opened by
<code><a href="../reference/find_gcp_coords.html">find_gcp_coords()</a></code>
</div>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gcp_europe_coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_gcp_coords.html">find_gcp_coords</a></span><span class="op">(</span><span class="va">gcp_europe</span>, <span class="va">europe</span><span class="op">)</span></span></code></pre></div>
<p>This will open a new window with the map of Europe, and you can click
on the points to assign coordinates to the GCPs.</p>
<p>Now the <code>gcp_europe_coords</code> dataframe contains the
geographic coordinates of the GCPs:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gcp_europe_coords</span></span>
<span><span class="co">#&gt;   id         x         y  longitude latitude</span></span>
<span><span class="co">#&gt; 1  1  830.3113  576.5869  -9.071636 37.16461</span></span>
<span><span class="co">#&gt; 2  2 2399.7464  783.3988  18.132085 40.06647</span></span>
<span><span class="co">#&gt; 3  3 2886.9187 2617.8971  41.207327 67.11767</span></span>
<span><span class="co">#&gt; 4  4  414.0564 2537.4702 -24.627151 65.64215</span></span>
<span><span class="co">#&gt; 5  5  836.4781 1645.1151 -10.472369 51.87063</span></span>
<span><span class="co">#&gt; 6  6 1992.7416  561.2675  10.907249 37.11543</span></span></code></pre></div>
<p>Finally, we can use the <code>georeference_image()</code> function to
georeference the image using the GCPs. This function will create a new
TIFF file with the georeferenced image.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">georeferenced_image</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/georeference_img.html">georeference_img</a></span><span class="op">(</span><span class="va">img_path</span>, <span class="va">gcp_europe_coords</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/georeference_img.html">georeference_img()</a></code> function will create a new TIFF
file with the georeferenced image. The output file will have the same
name as the input image, but with the suffix <code>_warp.tif</code>
added to it.</p>
<p>The georeferenced image can be loaded into R using the
<code>terra</code> package as a SpatRaster:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_warp</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">georeferenced_image</span><span class="op">)</span></span></code></pre></div>
<p>We can now plot the georeferenced image to check the overlap between
the input image and the georeferenced image. This can inform us if more
points (GCPs) need to be added and previous steps repeated
(<code><a href="../reference/choose_gcp.html">choose_gcp()</a></code>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dieghernan.github.io/tidyterra/" class="external-link">tidyterra</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster_rgb.html" class="external-link">geom_spatraster_rgb</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">map_warp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">europe</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"transparent"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="img/europe_georeferenced_version1.png" width="500" alt="Figure: Warped image superimposed on a reference map with country borders"><div class="figcaption">Figure: Warped image superimposed on a reference
map with country borders</div>
</div>
<p>To add more points to improve the fit, we use:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gcp_europe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/choose_gcp.html">choose_gcp</a></span><span class="op">(</span><span class="va">img_path</span>, gcp <span class="op">=</span> <span class="va">gcp_europe</span><span class="op">)</span></span></code></pre></div>
<p>Additional points were added to the <code>gcp_europe</code>
dataframe:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gcp_europe</span></span>
<span><span class="co">#&gt;    id         x         y longitude latitude</span></span>
<span><span class="co">#&gt; 1   1  830.3113  576.5869        NA       NA</span></span>
<span><span class="co">#&gt; 2   2 2399.7464  783.3988        NA       NA</span></span>
<span><span class="co">#&gt; 3   3 2886.9187 2617.8971        NA       NA</span></span>
<span><span class="co">#&gt; 4   4  414.0564 2537.4702        NA       NA</span></span>
<span><span class="co">#&gt; 5   5  836.4781 1645.1151        NA       NA</span></span>
<span><span class="co">#&gt; 6   6 1992.7416  561.2675        NA       NA</span></span>
<span><span class="co">#&gt; 7   7 2641.4229  246.7386        NA       NA</span></span>
<span><span class="co">#&gt; 8   8 2576.9680  632.6570        NA       NA</span></span>
<span><span class="co">#&gt; 9   9 2377.7439 2189.4124        NA       NA</span></span>
<span><span class="co">#&gt; 10 10 2190.2389 2457.5930        NA       NA</span></span>
<span><span class="co">#&gt; 11 11 2172.6603 2156.7075        NA       NA</span></span>
<span><span class="co">#&gt; 12 12 2108.2054 1960.4778        NA       NA</span></span>
<span><span class="co">#&gt; 13 13 1826.9479 2032.4287        NA       NA</span></span>
<span><span class="co">#&gt; 14 14 1668.7405 2065.1336        NA       NA</span></span>
<span><span class="co">#&gt; 15 15 1112.0849 1417.5757        NA       NA</span></span>
<span><span class="co">#&gt; 16 16 1258.5732 2032.4287        NA       NA</span></span></code></pre></div>
<p>Check the map with the original points</p>
<div class="float">
<img src="img/europe_image_GCP2.png" width="500" alt="Figure: Additional GCPs added on the image."><div class="figcaption">Figure: Additional GCPs added on the
image.</div>
</div>
<p>Now we can repeat the process of assigning coordinates to the GCPs
using <code><a href="../reference/find_gcp_coords.html">find_gcp_coords()</a></code> and
<code><a href="../reference/georeference_img.html">georeference_img()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gcp_europe_coords_v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_gcp_coords.html">find_gcp_coords</a></span><span class="op">(</span><span class="va">gcp_europe</span>, <span class="va">europe</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gcp_europe_coords_v2</span></span></code></pre></div>
<p>Run the following code chunk to save the object if you are recreating
the vignette</p>
<p>Repeat georeferencing of the image using the GCPs</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">georeferenced_image_v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/georeference_img.html">georeference_img</a></span><span class="op">(</span><span class="va">img_path</span>, <span class="va">gcp_europe_coords_v2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map_warp_v2</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">georeferenced_image_v2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check the new image</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster_rgb.html" class="external-link">geom_spatraster_rgb</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">map_warp_v2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">europe</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"transparent"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="img/europe_georeferenced_version2.png" width="500" alt="Figure: Revised warped image superimposed on the reference map."><div class="figcaption">Figure: Revised warped image superimposed on the
reference map.</div>
</div>
<p>We can see that the additional points improved the georeferencing of
the image, as the map now aligns better with the geographic coordinates
of the GCPs.</p>
<p>We now use locator to get the coordinates of the blue dots</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the coordinates of the blues points</span></span>
<span><span class="va">blue_coords_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_coords.html">extract_coords</a></span><span class="op">(</span><span class="va">map_warp_v2</span><span class="op">)</span></span></code></pre></div>
<p>So we now have the coordinates of the blue dots:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">blue_coords_df</span></span>
<span><span class="co">#&gt;   id   longitude latitude</span></span>
<span><span class="co">#&gt; 1  1  -3.2609722 40.36582</span></span>
<span><span class="co">#&gt; 2  2  12.5085660 41.72656</span></span>
<span><span class="co">#&gt; 3  3  12.9900786 52.31006</span></span>
<span><span class="co">#&gt; 4  4  -0.4922746 51.47850</span></span>
<span><span class="co">#&gt; 5  5 -22.4010987 64.17870</span></span></code></pre></div>
<p>There are only 5 entries - we forgot one of the dots, let’s re run
the function:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">blue_coords_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_coords.html">extract_coords</a></span><span class="op">(</span><span class="va">map_warp_v2</span>, <span class="va">blue_coords_df</span><span class="op">)</span></span></code></pre></div>
<p>So we now we can see check that all the blue dots have been
recorded:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">blue_coords_df</span></span>
<span><span class="co">#&gt;   id   longitude latitude</span></span>
<span><span class="co">#&gt; 1  1  -3.2609722 40.36582</span></span>
<span><span class="co">#&gt; 2  2  12.5085660 41.72656</span></span>
<span><span class="co">#&gt; 3  3  12.9900786 52.31006</span></span>
<span><span class="co">#&gt; 4  4  -0.4922746 51.47850</span></span>
<span><span class="co">#&gt; 5  5 -22.4010987 64.17870</span></span>
<span><span class="co">#&gt; 6  6   1.9152885 48.68143</span></span></code></pre></div>
<p>Starting from a non georeferenced image, we were then able to extract
the coordinates of our locations of interest.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Andrea Manica, Andrea Pozzi, Cecilia Padilla-Iglesias, Evie Carter, Michela Leonardi, Aramish Fatima, Ondrej Pelanek, Nile Stephenson, Margherita Colucci.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
